var parametrageNiveau=

  [
		{
				id:"01",
				Ennemis:[
					{
						vitesse:1,
						rotation:0.1
					},
					{
						vitesse:2,
						rotation:0.2
					},
					{
						vitesse:2,
						rotation:0.2
					}
				],
				AireForme:56,
				Points:[
					{
						x:50,
						y:50
					},
					{
						x:250,
						y:50
					},
					{
						x:180,
						y:175
					},
					{
						x:250,
						y:300
					},
					{
						x:50,
						y:300
					},
					{
						x:120,
						y:175
					},
					{
						x:50,
						y:50
					}
					
				]
				
				
		},
		{
				id:"02",
				
				Ennemis:[
					{
						vitesse:1,
						rotation:0.1
					},
					{
						vitesse:2,
						rotation:0.2
					}
				],
				AireForme:56,
				Points:[
					{
						x:0,
						y:300
					},
					{
						x:150,
						y:0
					},
					{
						x:300,
						y:300
					},
					{
						x:150,
						y:150
					},
					{
						x:150,
						y:300
					},
					{
						x:75,
						y:200
					},
					{
						x:0,
						y:300
					}
					
				]
		}
		,

		{
				id:"03",
				Ennemis:[
					{
						vitesse:1,
						rotation:0.1
					},
					{
						vitesse:2,
						rotation:0.2
					}
				],
				AireForme:56,
				Points:[
					{x:150,y:50},
					{x:180,y:145},
					{x:270,y:150},
					{x:200,y:205},
					{x:225,y:300},
					{x:150,y:245},
					{x:75,y:300},
					{x:100,y:205},
					{x:30,y:150},
					{x:120,y:145},
					{x:150,y:50}
				]
				
				
		},
		{
				id:"04",
				Ennemis:[
					{
						vitesse:1,
						rotation:0.1
					},
					{
						vitesse:2,
						rotation:0.2
					}
				],
				AireForme:56,
				Points:[
					{x:135, y:60},
					{x:95, y:137},
					{x:96, y:195},
					{x:100, y:208},
					{x:89, y:246},
					{x:112, y:292},
					{x:116, y:243},
					{x:127, y:252},
					{x:121, y:272},
					{x:162, y:270},
					{x:156, y:248},
					{x:165, y:240},
					{x:173, y:290},
					{x:194, y:244},
					{x:178, y:204},
					{x:182, y:184},
					{x:180, y:126},
					{x:135, y:60}
				]
				
				
		},
		{
				id:"05",
				Ennemis:[
					{
						vitesse:1,
						rotation:0.1
					},
					{
						vitesse:2,
						rotation:0.2
					}
				],
				AireForme:56,
				Points:[
					{x:75,y:65},
					{x:44,y:94},
					{x:28,y:123},
					{x:21,y:150},
					{x:21,y:182},
					{x:31,y:211},
					{x:46,y:235},
					{x:66,y:254},
					{x:93,y:270},
					{x:124,y:280},
					{x:150,y:283},
					{x:184,y:278},
					{x:209,y:267},
					{x:234,y:251},
					{x:253,y:229},
					{x:267,y:206},
					{x:273,y:178},
					{x:261,y:199},
					{x:243,y:216},
					{x:219,y:230},
					{x:196,y:238},
					{x:173,y:240},
					{x:150,y:238},
					{x:124,y:231},
					{x:101,y:219},
					{x:82,y:204},
					{x:66,y:184},
					{x:54,y:158},
					{x:50,y:137},
					{x:51,y:114},
					{x:56,y:95},
					{x:64,y:79},
					{x:75,y:65}
				]
				
				
		},
		{
				id:"06",
				Ennemis:[
					{
						vitesse:1,
						rotation:0.1
					},
					{
						vitesse:2,
						rotation:0.2
					}
				],
				AireForme:56,
				Points:[
					{x:158,y:65},
					{x:137,y:67},
					{x:113,y:74},
					{x:90,y:90},
					{x:73,y:108},
					{x:69,y:119},
					{x:49,y:121},
					{x:30,y:127},
					{x:16,y:141},
					{x:12,y:150},
					{x:15,y:161},
					{x:24,y:176},
					{x:38,y:188},
					{x:57,y:200},
					{x:79,y:209},
					{x:61,y:231},
					{x:76,y:253},
					{x:61,y:276},
					{x:112,y:263},
					{x:87,y:249},
					{x:77,y:232},
					{x:95,y:215},
					{x:123,y:218},
					{x:155,y:219},
					{x:145,y:247},
					{x:153,y:264},
					{x:147,y:286},
					{x:184,y:271},
					{x:167,y:259},
					{x:159,y:244},
					{x:170,y:221},
					{x:192,y:218},
					{x:211,y:215},
					{x:232,y:242},
					{x:223,y:261},
					{x:204,y:271},
					{x:241,y:289},
					{x:236,y:264},
					{x:248,y:243},
					{x:228,y:213},
					{x:254,y:203},
					{x:276,y:184},
					{x:285,y:169},
					{x:281,y:158},
					{x:267,y:138},
					{x:251,y:129},
					{x:235,y:124},
					{x:227,y:104},
					{x:213,y:88},
					{x:195,y:75},
					{x:177,y:68},
					{x:158,y:65}
				]
				
				
		},
		{
				id:"07",
				Ennemis:[
					{
						vitesse:1,
						rotation:0.1
					},
					{
						vitesse:2,
						rotation:0.2
					}
				],
				AireForme:56,
				Points:[
					{x:137,y:109},
					{x:125,y:114},
					{x:108,y:124},
					{x:97,y:134},
					{x:92,y:143},
					{x:74,y:122},
					{x:91,y:169},
					{x:96,y:170},
					{x:107,y:181},
					{x:102,y:188},
					{x:104,y:193},
					{x:88,y:202},
					{x:84,y:223},
					{x:74,y:227},
					{x:63,y:233},
					{x:47,y:250},
					{x:68,y:247},
					{x:65,y:273},
					{x:80,y:254},
					{x:91,y:266},
					{x:95,y:233},
					{x:99,y:224},
					{x:107,y:222},
					{x:109,y:244},
					{x:114,y:267},
					{x:90,y:287},
					{x:118,y:292},
					{x:144,y:290},
					{x:149,y:281},
					{x:150,y:263},
					{x:153,y:281},
					{x:157,y:290},
					{x:188,y:292},
					{x:211,y:290},
					{x:191,y:268},
					{x:196,y:240},
					{x:198,y:211},
					{x:217,y:200},
					{x:227,y:188},
					{x:239,y:183},
					{x:245,y:172},
					{x:259,y:157},
					{x:241,y:161},
					{x:244,y:135},
					{x:226,y:154},
					{x:217,y:142},
					{x:216,y:171},
					{x:192,y:185},
					{x:193,y:178},
					{x:188,y:174},
					{x:199,y:156},
					{x:205,y:152},
					{x:206,y:101},
					{x:194,y:130},
					{x:181,y:118},
					{x:162,y:111},
					{x:145,y:109},
					{x:140,y:80},
					{x:142,y:75},
					{x:137,y:70},
					{x:132,y:76},
					{x:135,y:81},
					{x:137,y:109}
				]
				
				
		},
		{
				id:"08",
				Ennemis:[
					{
						vitesse:1,
						rotation:0.1
					},
					{
						vitesse:2,
						rotation:0.2
					}
				],
				AireForme:56,
				Points:[
					{x:131,y:61},
					{x:107,y:65},
					{x:82,y:74},
					{x:67,y:88},
					{x:57,y:109},
					{x:52,y:128},
					{x:49,y:162},
					{x:41,y:178},
					{x:27,y:214},
					{x:18,y:247},
					{x:51,y:244},
					{x:76,y:243},
					{x:98,y:267},
					{x:170,y:267},
					{x:192,y:243},
					{x:218,y:243},
					{x:247,y:247},
					{x:237,y:213},
					{x:227,y:181},
					{x:218,y:155},
					{x:214,y:131},
					{x:211,y:111},
					{x:202,y:90},
					{x:188,y:74},
					{x:160,y:66},
					{x:131,y:61}
				]
				
				
		},
		{
				id:"09",
				Ennemis:[
					{
						vitesse:1,
						rotation:0.1
					},
					{
						vitesse:2,
						rotation:0.2
					}
				],
				AireForme:56,
				Points:[
					{x:204,y:59},
					{x:192,y:102},
					{x:149,y:83},
					{x:166,y:118},
					{x:146,y:126},
					{x:121,y:141},
					{x:99,y:157},
					{x:77,y:174},
					{x:58,y:193},
					{x:38,y:213},
					{x:18,y:245},
					{x:44,y:233},
					{x:68,y:226},
					{x:65,y:258},
					{x:66,y:300},
					{x:86,y:267},
					{x:100,y:242},
					{x:118,y:217},
					{x:136,y:194},
					{x:156,y:171},
					{x:175,y:153},
					{x:191,y:142},
					{x:206,y:184},
					{x:223,y:142},
					{x:265,y:154},
					{x:239,y:121},
					{x:266,y:89},
					{x:224,y:97},
					{x:204,y:59}
				]
				
				
		},
		{
				id:"10",
				Ennemis:[
					{
						vitesse:1,
						rotation:0.1
					},
					{
						vitesse:2,
						rotation:0.2
					}
				],
				AireForme:56,
				Points:[
					{x:187,y:82},
					{x:173,y:96},
					{x:156,y:111},
					{x:142,y:124},
					{x:129,y:121},
					{x:122,y:128},
					{x:105,y:110},
					{x:120,y:81},
					{x:65,y:55},
					{x:28,y:134},
					{x:70,y:157},
					{x:84,y:137},
					{x:102,y:148},
					{x:95,y:163},
					{x:98,y:176},
					{x:83,y:193},
					{x:77,y:184},
					{x:64,y:170},
					{x:50,y:161},
					{x:42,y:158},
					{x:35,y:167},
					{x:31,y:180},
					{x:31,y:196},
					{x:33,y:212},
					{x:34,y:225},
					{x:22,y:230},
					{x:17,y:228},
					{x:15,y:235},
					{x:21,y:238},
					{x:23,y:233},
					{x:36,y:229},
					{x:42,y:246},
					{x:49,y:261},
					{x:58,y:274},
					{x:69,y:287},
					{x:78,y:293},
					{x:84,y:290},
					{x:91,y:277},
					{x:96,y:262},
					{x:97,y:244},
					{x:95,y:232},
					{x:121,y:203},
					{x:130,y:207},
					{x:141,y:206},
					{x:153,y:197},
					{x:180,y:222},
					{x:169,y:247},
					{x:225,y:270},
					{x:267,y:194},
					{x:221,y:160},
					{x:203,y:189},
					{x:175,y:169},
					{x:178,y:162},
					{x:176,y:151},
					{x:193,y:133},
					{x:205,y:120},
					{x:217,y:107},
					{x:238,y:118},
					{x:253,y:96},
					{x:193,y:54},
					{x:170,y:69},
					{x:187,y:82}
				]
				
				
		},
		{
				id:"11",
				Ennemis:[
					{
						vitesse:1,
						rotation:0.1
					},
					{
						vitesse:2,
						rotation:0.2
					}
				],
				AireForme:56,
				Points:[
					{x:136,y:55},
					{x:121,y:57},
					{x:106,y:65},
					{x:95,y:77},
					{x:88,y:94},
					{x:89,y:110},
					{x:98,y:125},
					{x:114,y:131},
					{x:119,y:132},
					{x:119,y:136},
					{x:108,y:139},
					{x:93,y:148},
					{x:83,y:164},
					{x:76,y:179},
					{x:70,y:193},
					{x:64,y:204},
					{x:65,y:211},
					{x:73,y:216},
					{x:83,y:214},
					{x:85,y:205},
					{x:89,y:200},
					{x:92,y:206},
					{x:96,y:204},
					{x:97,y:198},
					{x:93,y:191},
					{x:94,y:184},
					{x:102,y:170},
					{x:112,y:161},
					{x:109,y:180},
					{x:103,y:203},
					{x:96,y:231},
					{x:94,y:254},
					{x:93,y:275},
					{x:74,y:288},
					{x:90,y:297},
					{x:111,y:296},
					{x:124,y:290},
					{x:124,y:277},
					{x:119,y:271},
					{x:120,y:246},
					{x:128,y:222},
					{x:143,y:222},
					{x:150,y:246},
					{x:151,y:267},
					{x:146,y:275},
					{x:147,y:288},
					{x:159,y:295},
					{x:179,y:296},
					{x:198,y:293},
					{x:198,y:287},
					{x:177,y:274},
					{x:175,y:250},
					{x:172,y:225},
					{x:166,y:201},
					{x:161,y:178},
					{x:158,y:165},
					{x:170,y:173},
					{x:176,y:185},
					{x:177,y:191},
					{x:172,y:199},
					{x:174,y:206},
					{x:180,y:202},
					{x:185,y:206},
					{x:192,y:215},
					{x:202,y:212},
					{x:204,y:202},
					{x:197,y:189},
					{x:191,y:173},
					{x:181,y:156},
					{x:167,y:142},
					{x:154,y:137},
					{x:154,y:133},
					{x:166,y:128},
					{x:178,y:117},
					{x:183,y:102},
					{x:180,y:86},
					{x:169,y:70},
					{x:156,y:60},
					{x:136,y:55}
				]
				
				
		},
		{
				id:"12",
				Ennemis:[
					{
						vitesse:1,
						rotation:0.1
					},
					{
						vitesse:2,
						rotation:0.2
					}
				],
				AireForme:56,
				Points:[
									{x:212,y:147},
					{x:204,y:134},
					{x:192,y:123},
					{x:178,y:113},
					{x:162,y:108},
					{x:144,y:107},
					{x:126,y:110},
					{x:111,y:117},
					{x:97,y:127},
					{x:86,y:139},
					{x:77,y:155},
					{x:72,y:171},
					{x:71,y:185},
					{x:71,y:197},
					{x:57,y:202},
					{x:40,y:212},
					{x:23,y:225},
					{x:13,y:235},
					{x:12,y:245},
					{x:23,y:249},
					{x:38,y:249},
					{x:55,y:249},
					{x:74,y:246},
					{x:91,y:242},
					{x:101,y:252},
					{x:114,y:262},
					{x:128,y:268},
					{x:145,y:270},
					{x:161,y:270},
					{x:178,y:266},
					{x:193,y:257},
					{x:206,y:246},
					{x:215,y:231},
					{x:222,y:215},
					{x:224,y:199},
					{x:242,y:190},
					{x:260,y:180},
					{x:277,y:168},
					{x:288,y:156},
					{x:288,y:145},
					{x:277,y:141},
					{x:261,y:139},
					{x:241,y:141},
					{x:226,y:143},
					{x:212,y:147}
				]
				
				
		},
		{
				id:"13",
				Ennemis:[
					{
						vitesse:1,
						rotation:0.1
					},
					{
						vitesse:2,
						rotation:0.2
					}
				],
				AireForme:56,
				Points:[
				{x:154,y:88},
				{x:151,y:79},
				{x:152,y:68},
				{x:130,y:70},
				{x:111,y:83},
				{x:102,y:93},
				{x:106,y:104},
				{x:117,y:107},
				{x:144,y:110},
				{x:142,y:125},
				{x:137,y:148},
				{x:119,y:149},
				{x:91,y:177},
				{x:89,y:196},
				{x:71,y:198},
				{x:37,y:278},
				{x:66,y:280},
				{x:92,y:262},
				{x:180,y:261},
				{x:212,y:289},
				{x:246,y:289},
				{x:230,y:210},
				{x:213,y:208},
				{x:214,y:185},
				{x:192,y:153},
				{x:166,y:148},
				{x:163,y:124},
				{x:163,y:108},
				{x:191,y:110},
				{x:202,y:107},
				{x:207,y:97},
				{x:201,y:85},
				{x:187,y:76},
				{x:174,y:68},
				{x:159,y:69},
				{x:158,y:78},
				{x:154,y:88}
				]
				
				
		},
		{
				id:"14",
				Ennemis:[
					{
						vitesse:1,
						rotation:0.1
					},
					{
						vitesse:2,
						rotation:0.2
					}
				],
				AireForme:56,
				Points:[
					{x:278,y:65},
					{x:198,y:81},
					{x:165,y:107},
					{x:105,y:131},
					{x:45,y:122},
					{x:27,y:138},
					{x:42,y:159},
					{x:14,y:173},
					{x:42,y:208},
					{x:63,y:184},
					{x:103,y:236},
					{x:72,y:247},
					{x:101,y:285},
					{x:121,y:261},
					{x:140,y:283},
					{x:159,y:269},
					{x:167,y:202},
					{x:205,y:157},
					{x:240,y:135},
					{x:278,y:65}
				]
				
				
		},
		{
				id:"15",
				Ennemis:[
					{
						vitesse:1,
						rotation:0.1
					},
					{
						vitesse:2,
						rotation:0.2
					}
				],
				AireForme:56,
				Points:[
									{x:130,y:158},
					{x:125,y:133},
					{x:123,y:108},
					{x:125,y:79},
					{x:121,y:74},
					{x:114,y:72},
					{x:109,y:76},
					{x:106,y:88},
					{x:105,y:102},
					{x:97,y:101},
					{x:90,y:106},
					{x:88,y:120},
					{x:87,y:144},
					{x:85,y:169},
					{x:83,y:204},
					{x:79,y:228},
					{x:80,y:247},
					{x:81,y:271},
					{x:92,y:290},
					{x:113,y:296},
					{x:137,y:295},
					{x:161,y:291},
					{x:183,y:280},
					{x:204,y:268},
					{x:219,y:253},
					{x:236,y:238},
					{x:248,y:226},
					{x:260,y:216},
					{x:261,y:210},
					{x:255,y:205},
					{x:247,y:203},
					{x:239,y:204},
					{x:231,y:209},
					{x:219,y:219},
					{x:204,y:232},
					{x:197,y:235},
					{x:189,y:234},
					{x:183,y:222},
					{x:179,y:209},
					{x:177,y:196},
					{x:182,y:177},
					{x:184,y:158},
					{x:186,y:138},
					{x:188,y:123},
					{x:188,y:104},
					{x:188,y:91},
					{x:184,y:82},
					{x:175,y:80},
					{x:172,y:69},
					{x:165,y:65},
					{x:160,y:65},
					{x:154,y:71},
					{x:152,y:83},
					{x:148,y:96},
					{x:144,y:119},
					{x:138,y:140},
					{x:130,y:158}
				]
				
				
		},
		{
				id:"16",
				Ennemis:[
					{
						vitesse:1,
						rotation:0.1
					},
					{
						vitesse:2,
						rotation:0.2
					}
				],
				AireForme:56,
				Points:[
					{x:142,y:58},
					{x:122,y:119},
					{x:113,y:123},
					{x:63,y:100},
					{x:89,y:145},
					{x:83,y:155},
					{x:22,y:177},
					{x:82,y:196},
					{x:88,y:208},
					{x:62,y:250},
					{x:111,y:230},
					{x:122,y:235},
					{x:142,y:298},
					{x:163,y:236},
					{x:175,y:232},
					{x:224,y:252},
					{x:199,y:206},
					{x:204,y:195},
					{x:265,y:176},
					{x:203,y:158},
					{x:199,y:146},
					{x:224,y:102},
					{x:173,y:123},
					{x:163,y:119},
					{x:142,y:58}

				]
				
				
		},
		{
				id:"17",
				Ennemis:[
					{
						vitesse:1,
						rotation:0.1
					},
					{
						vitesse:2,
						rotation:0.2
					}
				],
				AireForme:56,
				Points:[
					{x:56,y:97},
					{x:56,y:116},
					{x:81,y:116},
					{x:81,y:134},
					{x:56,y:135},
					{x:55,y:154},
					{x:31,y:154},
					{x:31,y:175},
					{x:4,y:175},
					{x:4,y:234},
					{x:30,y:234},
					{x:30,y:195},
					{x:55,y:195},
					{x:55,y:236},
					{x:81,y:236},
					{x:82,y:253},
					{x:134,y:253},
					{x:134,y:235},
					{x:82,y:235},
					{x:82,y:216},
					{x:213,y:216},
					{x:213,y:234},
					{x:160,y:234},
					{x:160,y:253},
					{x:214,y:253},
					{x:214,y:235},
					{x:240,y:235},
					{x:240,y:195},
					{x:264,y:195},
					{x:264,y:234},
					{x:292,y:234},
					{x:292,y:176},
					{x:264,y:176},
					{x:264,y:156},
					{x:241,y:156},
					{x:241,y:135},
					{x:213,y:135},
					{x:213,y:115},
					{x:241,y:115},
					{x:241,y:97},
					{x:212,y:97},
					{x:212,y:114},
					{x:187,y:114},
					{x:187,y:134},
					{x:109,y:134},
					{x:109,y:115},
					{x:82,y:115},
					{x:82,y:97},
					{x:56,y:97}



				]
				
				
		},
		{
				id:"18",
				Ennemis:[
					{
						vitesse:1,
						rotation:0.1
					},
					{
						vitesse:2,
						rotation:0.2
					}
				],
				AireForme:56,
				Points:[
					{x:114,y:63},
					{x:114,y:78},
					{x:81,y:78},
					{x:81,y:94},
					{x:64,y:94},
					{x:64,y:110},
					{x:47,y:110},
					{x:47,y:159},
					{x:29,y:159},
					{x:29,y:289},
					{x:43,y:289},
					{x:43,y:274},
					{x:62,y:274},
					{x:62,y:258},
					{x:78,y:258},
					{x:78,y:273},
					{x:95,y:273},
					{x:95,y:289},
					{x:130,y:289},
					{x:130,y:258},
					{x:165,y:258},
					{x:165,y:289},
					{x:199,y:289},
					{x:199,y:274},
					{x:216,y:274},
					{x:216,y:258},
					{x:232,y:258},
					{x:232,y:274},
					{x:251,y:274},
					{x:251,y:289},
					{x:269,y:289},
					{x:269,y:144},
					{x:252,y:144},
					{x:252,y:113},
					{x:234,y:113},
					{x:234,y:97},
					{x:217,y:97},
					{x:217,y:79},
					{x:183,y:79},
					{x:183,y:63},
					{x:114,y:63}
				]
				
				
		}
		
		
		
	];

var indexedDB=window.indexedDB || window.mozIndexedDB || window.webkitIndexedDB || window.msIndexedDB;

//prefixes of window.IDB objects
window.IDBTransaction = window.IDBTransaction || window.webkitIDBTransaction || window.msIDBTransaction;
window.IDBKeyRange = window.IDBKeyRange || window.webkitIDBKeyRange || window.msIDBKeyRange

majNiveaux();


 
function createDatabase(event) {
    var db = event.target.transaction.db;
    
    var sauvegardeStore = db.createObjectStore("sauvegarde",{keyPath: "id"});
	var NiveauStore = db.createObjectStore("niveaux",{keyPath: "id"});
	for (var i in parametrageNiveau) {
        NiveauStore.add(parametrageNiveau[i]);   
    }

}

/**
 * le callback quand il y a une erreur à l'ouverture
 */
function errorOpen(event) {
    window.alert("Erreur ouverture !");
}


/**
 * .
 * ajoute ou remplace une sauvegarde dans la base
 */
function saveSauvegarde(id,nbCoupe,aireAtteinte,temps,score) {
    // création d'un objet contenant les données
    // il sert d'"enregistrement" dans la base
    var sauvegarde = {
		id:id,
        nbCoupe:  nbCoupe,
        aireMinimaleAtteinte:   aireAtteinte,
		temps:temps,
		score:score
    }

    // on ouvre la base, et on déclare les listeners
    var request = indexedDB.open("spacelash2", 1);
    request.onerror = errorOpen;
    request.onupgradeneeded = createDatabase;

    request.onsuccess = function(event) {
        // ici la base a été ouverte avec succés, il faut ajouter l'enregistrement

        // on récupère l'objet database
        var db = event.target.result; 

        // on ouvre une transaction qui permettra d'effectuer
        // les opérations sur la base
        var transaction = db.transaction(["sauvegarde"], "readwrite");
        transaction.oncomplete = function(event) {
          
           
        };

        transaction.onerror = function(event) {
           window.alert('erreur de transaction ');
        };

        // on récupère l'object store dans lequel on veut stocker l'objet
        var sauvegardeStore = transaction.objectStore("sauvegarde");

        // on créé l'ordre d'ajouter un enregistrement
        // sera effectivement executé lors de la fermeture de la transaction
        var req = sauvegardeStore.put(sauvegarde);
        req.onsuccess = function(event) {
            
        }
        req.onerror = function(event) {
            window.alert('erreur ajout');
        }
    }
}

function readNiveau(idNiveau) {

	// on ouvre la base, et on déclare les listeners
    var request = indexedDB.open("spacelash2", 1);
	var resultat="";
    request.onerror = errorOpen;
    request.onupgradeneeded = createDatabase;

    request.onsuccess = function(event) {
        // ici la base a été ouverte avec succés, il faut ajouter l'enregistrement

        // on récupère l'objet database
        var db = event.target.result; 
		
        // on ouvre une transaction qui permettra d'effectuer
        // les opérations sur la base
        var transaction = db.transaction(["niveaux"], "readwrite");
        transaction.oncomplete = function(event) {
            window.alert("Transaction terminée, sauvegarde effectuée");
        };

        transaction.onerror = function(event) {
           window.alert('erreur de transaction ');
        };

        // on récupère l'object store dans lequel on veut stocker l'objet
        var sauvegardeStore = transaction.objectStore("niveaux");

        // on créé l'ordre d'ajouter un enregistrement
        // sera effectivement executé lors de la fermeture de la transaction
        var req = sauvegardeStore.get(idNiveau);

        req.onsuccess = function(event) {
            if(req.result) {
			resultat= req.result;
			oNiveauPartie = resultat;
			} 
			else {
			alert("Bug");  
			}
        }

        req.onerror = function(event) {
            window.alert('erreur ajout');
        }

    }

	
	
}


function readAllNiveau(){

	// on ouvre la base, et on déclare les listeners
    var request = indexedDB.open("spacelash2", 1);
	var resultat="";
    request.onerror = errorOpen;
    request.onupgradeneeded = createDatabase;

    request.onsuccess = function(event) {
		var db = event.target.result; 
		// on ouvre une transaction qui permettra d'effectuer
		// la lecture. uniquement de la lecture -> "readonly"
		var transaction = db.transaction(["niveaux"], "readonly");
		transaction.oncomplete = function(event) {};
		transaction.onerror = function(event) {
		   window.alert('erreur de transaction lecture ');
		};

		// on récupère l'object store que l'on veut lire
		var niveauStore = transaction.objectStore("niveaux");
		niveauStore.openCursor().onsuccess = function (event) {

		var cursor = event.target.result;
			if (cursor) {
			
				var test = niveauStore.get(cursor.key);
				
				test.onsuccess = function (e) {
					oNiveauPartie.push(test.result); // un niveau
					cursor.continue();
				}
			}
			// plus de niveaux (fin de l'enregistrement)
			else
			{
				bChargementNiveauxComplet = true;
			}
			
		}
	}
}

function readAllSauvegarde(){

	// on ouvre la base, et on déclare les listeners
    var request = indexedDB.open("spacelash2", 1);

    request.onerror = errorOpen;
    request.onupgradeneeded = createDatabase;

    request.onsuccess = function(event) {
		var db = event.target.result; 
		// on ouvre une transaction qui permettra d'effectuer
		// la lecture. uniquement de la lecture -> "readonly"
		var transaction = db.transaction(["sauvegarde"], "readonly");
		transaction.oncomplete = function(event) {};
		transaction.onerror = function(event) {
		   window.alert('erreur de transaction lecture ');
		};

		// on récupère l'object store que l'on veut lire
		var sauvegardeStore = transaction.objectStore("sauvegarde");
		sauvegardeStore.openCursor().onsuccess = function (event) {

		var cursor = event.target.result;
			if (cursor) {
			
				var test = sauvegardeStore.get(cursor.key);
				
				test.onsuccess = function (e) {
					oSauvegarde.push(test.result); // une sauvegarde
					cursor.continue();
				}
			}
			// plus de niveaux (fin de l'enregistrement)
			else
			{
				bChargementSauvegardeComplet = true;
			}
			
		}
	}
}


/**
 * fonction qui efface tout le contenu de la base, quand on
 * clique sur le bouton "effacer" de la page
 */
function majNiveaux() {
    // on ouvre la base, et on déclare les listeners
    var request = indexedDB.open("spacelash2", 1);
    request.onerror = errorOpen;
    request.onupgradeneeded = createDatabase;

    request.onsuccess = function(event) {
        var db = event.target.result;

        // on ouvre une transaction qui permettra d'effectuer la suppression
        var transaction = db.transaction(["niveaux"], "readwrite");
        transaction.oncomplete = function(event) {};
        transaction.onerror = function(event) {
           window.alert('erreur de transaction suppression');
        };

        var niveauxStore = transaction.objectStore("niveaux");
        var reqVider = niveauxStore.clear();
        reqVider.onsuccess = function(event) {
        }
        reqVider.onerror = function(event) {
            window.alert('erreur suppression');
        }
		
		var majNiveaux=transaction.objectStore("niveaux");
		for (var i in parametrageNiveau) {
        majNiveaux.add(parametrageNiveau[i]);   
		}
		
		
    }
}






